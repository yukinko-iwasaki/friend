
<%= link_to products_path, method: :get, id: "yellowb" do %>
        <i class="icon-trash icon-white"></i> 目標にお金をかける！
      <% end %>

<%= link_to  group_path(id: @group_id), method: :get, id: "yellowb" do %>
        <i class="icon-trash icon-white"></i> グループページへ！
      <% end %>

<% if @goal.goaltype.to_i ==1 %>

 <h2 class="goaldeclaration">
<%= @goal.goal_name%>を
みんなで
<%=@goal.quantity%>
<%= @goal.qunit %>達成する
<br>
<%= @goal.deadline.month %>月<%= @goal.deadline.day %>日まで残り
  <%= @rest %> 日
  </h2>
  <div class="progresscontinuous">
<button id="progress">進捗データ入力</button>
<div class="inputtrack", title="進捗データ入力">



<%= form_for @track,:url => {:controller => 'tracks',:action=>'create', :goal_id=>params[:goal_id]}, remote: true do |f| %>

  <%= @goal.goal_name %> を
  <%=f.number_field :quantity %>
  <%= @goal.qunit%>完了


  <div class="col10 push1">
              <%= button_tag type: "submit", class: "btn btn--block" do %>
              入力<i class="icon-arrow-right"></i>
              <% end %>
            </div>
  <% end %>
  </div>

 

<div id= "progress_post">
<%= current_user.name %> のプログレス<br><%= @tracks.sum(:quantity)%>
<br>
メンバーの進捗状況<br>
<% @members.each do |member| %>
<% if member.user_id != current_user.id %>
<%= User.find_by(id: member.user_id).name %>
<%= @tracksmember.where(user_id: member.user_id).sum(:quantity) %> 達成


<br>
<% end %>


<% end %>
全員で<%= @tracksmember.sum(:quantity)*100/@aim.quantity %>%達成
<div class="progress">
<% if @aim.quantity!=0 %>
  <div class="progress-bar progress-bar-success progress-bar-striped" role="progressbar" aria-valuenow="40" aria-valuemin="0" aria-valuemax="100" style="width: <%= @tracksmember.sum(:quantity)*100/@aim.quantity %>%">
    <span class="sr-only">40% Complete (success)</span>
    <% else %>
     <div class="progress-bar progress-bar-success progress-bar-striped" role="progressbar" aria-valuenow="40" aria-valuemin="0" aria-valuemax="100" style="width: <%= 0 %>%">
    <span class="sr-only">40% Complete (success)</span>
    <% end %>
  </div>
</div>

</div>

<% else %>

<h2 class="goaldeclaration">
<%= @goal.goal_name%>を
毎 <%= @goal.frequency_unit %>

<%=@goal.quantity%>
回達成する
<br>
<%= @goal.deadline.month %>月<%= @goal.deadline.day %>日まで残り
  <%= @rest %> 日
  </h2>
<div class="progresscheck">
<button id="progress">進捗データ入力</button>
<div class="inputtrack", title="進捗データ入力">



<%= form_for @track,:url => {:controller => 'tracks',:action=>'create', :goal_id=>params[:goal_id]}, remote: true do |f| %>

  <%= @goal.goal_name %> を
  <%= @goal.quantity%>
  <%= @goal.qunit%>完了
 
  <%= f.check_box :check %>



  <div class="col10 push1">
              <%= button_tag type: "submit", class: "btn btn--block" do %>
              入力<i class="icon-arrow-right"></i>
              <% end %>
            </div>
  <% end %>
  </div>
  </div>



<div id= "progress_post2">

<%= @since %><%=  @goal.frequency_unit %>目 <%= @tracks.where(period: @tracksmax).count-1 %> 回達成!! 
</div>
 <% end %>
 


<% if @goal.goaltype.to_i ==2 %>
いままでの達成状況
<div class=pastprogress>
<table class="table table-striped table-bordered table-hover ">

<tr>
<% i=0 %>
  <th>期間</th>
<% while i<@memberlist.length do %>
<th><%=User.find(@memberlist[i]).name%></th>
<%i=i+1 %>
<% end %>
</tr>
<% k=0 %>
<% while k<@since do %>
<tr>
  <th><%=k %></th>

<% j=0 %>
<% while j<@memberlist.length do %>
<% if @tracksbyperiod.find_by(user_id: @memberlist[j], period: k) ==nil %>
<th>fail</th>
<% elsif  @tracksbyperiod.find_by(user_id: @memberlist[j], period: k).success == false%>
<th>fail</th>
<% else %>
<th> pass️</th>
<% end %>
<%j=j+1 %>
<% end %>
</tr>
<%k=k+1%>
<% end %>



<% end %>

  </table>
  </div>


<% if user_signed_in? %>
<div class="container_comment">
<%= form_for @comment, :url=>{:controller=>:goals,:action=> :commentcreate}, remote: true do |f| %>
<%= f.text_field :comment %>
<%= f.submit 'コメント' %>
<% end %>


<div class="comments">
 
  <%= render @comments %>
</div>
  </div>
  <% else %>
  <div class="container_comment">
  <div class="comments">
    <p>コメント一覧</p>

  <% @comments.each do |comment| %>
  
  <p>
  <strong><%= link_to comment.user.name, "/users/#{comment.user_id}" %></strong>
  <%= comment.comment %>
  </p>
  
  <% end %>
  </div>

  <% end %>
  </div>
  


  <script>
$(".inputtrack" ).dialog({autoOpen: false });
  $("#progress").click(function(){
  $(".inputtrack").dialog("open");
  });

  $(".inputtrack").submit(function(){
  $(this).dialog("close");
  });

  </script>